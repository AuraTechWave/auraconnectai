# Environment Configuration for AuraConnect Backend

# Database Configuration
# For Docker Compose use: postgresql://auraconnect:auraconnect@postgres:5432/auraconnect
DATABASE_URL=postgresql://username:password@localhost:5432/auraconnect
DATABASE_TEST_URL=postgresql://username:password@localhost:5432/auraconnect_test

# JWT Authentication (REQUIRED - Must be changed for production)
# Generate with: openssl rand -hex 32
JWT_SECRET_KEY=CHANGE-THIS-IN-PRODUCTION-USE-OPENSSL-RAND-HEX-32
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=30
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# Session Security (REQUIRED for production)
# Generate with: openssl rand -hex 32  
SESSION_SECRET=CHANGE-THIS-IN-PRODUCTION-USE-OPENSSL-RAND-HEX-32

# Application Secret Key (REQUIRED)
# Generate with: openssl rand -hex 32
SECRET_KEY=CHANGE-THIS-IN-PRODUCTION-USE-OPENSSL-RAND-HEX-32

# API Security & Rate Limiting
RATE_LIMIT_ENABLED=true
DEFAULT_RATE_LIMIT=100
AUTH_RATE_LIMIT=5
API_RATE_LIMIT_PER_MINUTE=60
CORS_ORIGINS=["http://localhost:3000", "https://yourdomain.com"]

# Payroll Configuration
DEFAULT_OVERTIME_THRESHOLD_HOURS=40.0
DEFAULT_BENEFIT_PRORATION_FACTOR=0.46
TAX_CALCULATION_TIMEOUT_SECONDS=30

# Redis Configuration (for production job tracking)
# For Docker Compose use: redis://redis:6379/0
REDIS_URL=redis://localhost:6379/0
REDIS_PASSWORD=your-redis-password

# Migration Options
# MIGRATION_STRICT=true forces startup to abort on Alembic errors; default continues with warning
# SKIP_MIGRATIONS=true bypasses Alembic entirely (useful while repairing the migration chain)
MIGRATION_STRICT=false
SKIP_MIGRATIONS=false

# Backend Startup Fallback
# When true (default), the Docker entrypoint falls back to a minimal health-only app if the
# full application import fails. Set to false once all dependencies/migrations are in place.
ALLOW_MINIMAL_FALLBACK=true

# Email Configuration (for notifications)
SMTP_SERVER=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your-email@company.com
SMTP_PASSWORD=your-app-password

# Environment Settings
ENVIRONMENT=development  # development, staging, production
DEBUG=true
LOG_LEVEL=INFO

# File Upload Limits
MAX_UPLOAD_SIZE_MB=10
ALLOWED_FILE_TYPES=["csv", "xlsx", "pdf"]

# Background Job Configuration
BACKGROUND_JOB_TIMEOUT_SECONDS=300
MAX_CONCURRENT_PAYROLL_JOBS=5

# Multi-tenant Configuration
DEFAULT_TENANT_ID=1
ENABLE_MULTI_TENANT=true

# ========== Inventory Deduction Configuration ==========

# When to trigger inventory deduction
# Options: order_placed, order_preparing, order_completed, order_served
INVENTORY_DEDUCTION_DEDUCTION_TRIGGER=order_completed

# Whether to allow negative inventory levels
INVENTORY_DEDUCTION_ALLOW_NEGATIVE_INVENTORY=false

# Whether to deduct inventory for cancelled items
INVENTORY_DEDUCTION_DEDUCT_CANCELLED_ITEMS=false

# Whether to automatically reverse inventory when order is cancelled
INVENTORY_DEDUCTION_AUTO_REVERSE_ON_CANCEL=true

# Alert thresholds (percentage of threshold)
INVENTORY_DEDUCTION_LOW_STOCK_ALERT_PERCENTAGE=20
INVENTORY_DEDUCTION_CRITICAL_STOCK_ALERT_PERCENTAGE=10

# Batch processing settings
INVENTORY_DEDUCTION_BATCH_DEDUCTION_SIZE=100

# Retry configuration
INVENTORY_DEDUCTION_MAX_DEDUCTION_RETRIES=3
INVENTORY_DEDUCTION_RETRY_DELAY_SECONDS=1

# Audit configuration
INVENTORY_DEDUCTION_ENABLE_DETAILED_AUDIT=true
INVENTORY_DEDUCTION_AUDIT_RETENTION_DAYS=90

# Performance optimization
INVENTORY_DEDUCTION_USE_BULK_OPERATIONS=true
INVENTORY_DEDUCTION_CACHE_RECIPE_LOOKUPS=true
INVENTORY_DEDUCTION_CACHE_TTL_SECONDS=300

# External sync
INVENTORY_DEDUCTION_SYNC_TO_EXTERNAL_POS=false
INVENTORY_DEDUCTION_EXTERNAL_SYNC_TIMEOUT=30

# Feature flags
INVENTORY_DEDUCTION_ENABLE_PARTIAL_FULFILLMENT=true
INVENTORY_DEDUCTION_ENABLE_RECIPE_SUBSTITUTIONS=false
INVENTORY_DEDUCTION_ENABLE_WASTE_TRACKING=true
